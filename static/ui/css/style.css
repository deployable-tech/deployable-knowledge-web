/* =========================================================
   THEME TOKENS (functional palette)
   - Tweak ONLY the vars in this block to reskin/retune contrast
   ========================================================= */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');


/* ---------- DARK (default) ---------- */
:root {
  color-scheme: dark;

  /* Typography */
  --font-body: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', 'Liberation Sans', sans-serif;
  --font-mono: ui-monospace, SFMono-Regular, Menlo, Consolas, 'Liberation Mono', monospace;

  /* Seed palette (OKLCH for perceptual control) */
  --tint:  oklch(0.52 0.06 260);  /* subtle blue-violet cast for neutrals */
  --brand: oklch(0.70 0.14 160);  /* teal-green accent (replaces #10a37f with richer gamut) */

  /* Depth knobs (how much tint vs. black for dark neutrals) */
  /* Increase the *tint* % for a cooler, lighter surface; decrease for deeper/inkier UI */
  --bg-black-0: 90%; --bg-tint-0: 10%;   /* background (deep) */
  --bg-black-1: 86%; --bg-tint-1: 14%;  /* panels/cards/windows */
  --bg-black-2: 82%; --bg-tint-2: 18%;  /* inputs/subsurfaces */

  
  /* Text ramps (white vs tint; raise white% for more contrast) */
  --fg-white-strong: 96%; --fg-tint-strong: 4%;
  --fg-white:        93%; --fg-tint:        7%;
  --fg-white-muted:  85%; --fg-tint-muted: 15%;
  --fg-white-subtle: 78%; --fg-tint-subtle:22%;

  /* Border strength (mix between fg and bg; raise fg% for crisper borders) */
  --border-fg: 16%;  --border-bg: 82%;
  --input-border-fg: 20%; --input-border-bg: 76%;

  /* Accent shades derived from brand */
  --accent:            var(--brand);
  --accent-contrast:   #ffffff;
  --accent-hover:      color-mix(in oklch, var(--brand) 80%, white 20%);
  --accent-pressed:    color-mix(in oklch, var(--brand) 80%, black 20%);

  /* Semantic */
  --ok:  oklch(0.78 0.13 150);
  --err: oklch(0.70 0.20 25);
  --danger: oklch(0.62 0.20 25);

  /* Rhythm & sizing */
  --space-1: 4px;  --space-2: 8px;  --space-3: 12px; --space-4: 16px; --space-5: 20px; --space-6: 24px;
  --border-w: 1px; --radius-1: 6px; --radius-2: 8px; --radius-3: 10px; --radius-pill: 999px;
  --win-min-w: 280px; --win-min-h: 160px;

  /* Effects & motion */
  --shadow-1: 0 1px 2px rgba(0,0,0,.45);
  --ring: 2px solid var(--accent);
  --speed-1: 120ms; --speed-2: 180ms; --ease-1: cubic-bezier(.2,.9,.3,1);

  /* ---- Derived neutrals (no hand-picked hex) ---- */
  --bg:        color-mix(in oklch, black var(--bg-black-0), var(--tint) var(--bg-tint-0));
  --panel-bg:  color-mix(in oklch, black var(--bg-black-1), var(--tint) var(--bg-tint-1));
  --surface-2: color-mix(in oklch, black var(--bg-black-2), var(--tint) var(--bg-tint-2));

  --fg-strong: color-mix(in oklch, white var(--fg-white-strong), var(--tint) var(--fg-tint-strong));
  --fg:        color-mix(in oklch, white var(--fg-white),        var(--tint) var(--fg-tint));
  --text-muted:  color-mix(in oklch, white var(--fg-white-muted),  var(--tint) var(--fg-tint-muted));
  --text-subtle: color-mix(in oklch, white var(--fg-white-subtle), var(--tint) var(--fg-tint-subtle));
  --title: var(--fg-strong);

  --border:       color-mix(in oklch, var(--fg) var(--border-fg),        var(--bg) var(--border-bg));
  --input-border: color-mix(in oklch, var(--fg) var(--input-border-fg),  var(--bg) var(--input-border-bg));
  --input-bg:     var(--surface-2);
}

/* ——— “Dim” (much lighter, still dark) ——— */
:root{
  --bg-black-0: 60%; --bg-tint-0: 16%;
  --bg-black-1: 55%; --bg-tint-1: 20%;
  --bg-black-2: 40%; --bg-tint-2: 24%;
  --border-fg: 14%; --input-border-fg: 18%;
}
/* SMOKE — very light “dark” */
:root{
  --bg-black-0: 56%; --bg-tint-0: 24%;
  --bg-black-1: 52%; --bg-tint-1: 48%;
  --bg-black-2: 48%; --bg-tint-2: 52%;
  --border-fg: 10%; --input-border-fg: 12%;
}

/* ---------- LIGHT (same seeds, flipped mixes) ---------- */
[data-theme="light"] {
  color-scheme: light;

  /* reuse --tint and --brand from :root for consistent branding */

  /* Depth knobs (white vs tint for light neutrals) */
  --lt-white-0: 96%; --lt-tint-0: 4%;   /* page background */
  --lt-white-1: 98%; --lt-tint-1: 2%;   /* panels */
  --lt-white-2: 100%; --lt-tint-2: 0%;  /* inputs */

  /* Text ramps (black vs tint) */
  --lt-black-strong: 92%; --lt-tint-strong: 8%;
  --lt-black:        88%; --lt-tint:        12%;
  --lt-black-muted:  65%; --lt-tint-muted:  35%;
  --lt-black-subtle: 52%; --lt-tint-subtle: 48%;

  /* Borders */
  --lt-border-fg: 20%; --lt-border-bg: 80%;
  --lt-input-border-fg: 24%; --lt-input-border-bg: 76%;

  --bg:        color-mix(in oklch, white var(--lt-white-0), var(--tint) var(--lt-tint-0));
  --panel-bg:  color-mix(in oklch, white var(--lt-white-1), var(--tint) var(--lt-tint-1));
  --surface-2: color-mix(in oklch, white var(--lt-white-2), var(--tint) var(--lt-tint-2));

  --fg-strong: color-mix(in oklch, black var(--lt-black-strong), var(--tint) var(--lt-tint-strong));
  --fg:        color-mix(in oklch, black var(--lt-black),        var(--tint) var(--lt-tint));
  --text-muted:  color-mix(in oklch, black var(--lt-black-muted),  var(--tint) var(--lt-tint-muted));
  --text-subtle: color-mix(in oklch, black var(--lt-black-subtle), var(--tint) var(--lt-tint-subtle));
  --title: var(--fg-strong);

  --border:       color-mix(in oklch, var(--fg) var(--lt-border-fg),       var(--bg) var(--lt-border-bg));
  --input-border: color-mix(in oklch, var(--fg) var(--lt-input-border-fg), var(--bg) var(--lt-input-border-bg));
  --input-bg:     var(--surface-2);

  --accent:         var(--brand);
  --accent-contrast:#ffffff;
  --accent-hover:   color-mix(in oklch, var(--brand) 75%, black 25%);
  --accent-pressed: color-mix(in oklch, var(--brand) 70%, black 30%);

  --ok:  oklch(0.55 0.13 150);
  --err: oklch(0.56 0.18 25);
  --danger: oklch(0.50 0.20 25);
}

/* =========================================================
   BASE / RESETS
   ========================================================= */
*,
*::before,
*::after { box-sizing: border-box; }

html, body { height: 100%; }

body {
  margin: 0;
  font-family: var(--font-body);
  background: var(--bg);
  color: var(--fg);
  line-height: 1.45;
}

img, svg, video { max-width: 100%; height: auto; }

:focus-visible { outline: var(--ring); outline-offset: 2px; }

a { color: inherit; text-decoration: none; }

/* =========================================================
   LAYOUT
   ========================================================= */

   /* Keep header/menu above the desktop window stack */
header { position: relative; z-index: 1000; }
main#desktop { position: relative; z-index: 0; }

header .menu { position: relative; }
header {
  padding: calc(var(--space-3) + 2px) var(--space-4);
  border-bottom: var(--border-w) solid var(--border);
  display: flex;
  gap: var(--space-3);
  align-items: center;
  position: relative;
}

header input,
header button,
header select {
  background: var(--input-bg);
  color: var(--fg);
  border: var(--border-w) solid var(--input-border);
  border-radius: var(--radius-1);
  padding: var(--space-2) var(--space-3);
}

header button { cursor: pointer; }

header .menu-list {
  display: none;
  position: absolute;
  top: 100%;
  left: 0;
  background: var(--panel-bg);
  border: var(--border-w) solid var(--border);
  border-radius: var(--radius-2);
  list-style: none;
  margin: var(--space-1) 0 0 0;
  padding: var(--space-1) 0;
  box-shadow: var(--shadow-1);
}
header .menu-list.visible { display: block; }
header .menu-list li {
  padding: var(--space-1) var(--space-3);
  white-space: nowrap;
  cursor: pointer;
}
header .menu-list li:hover { background: var(--surface-2); }

main {
  position: relative;
  padding: var(--space-4);
  min-height: calc(100vh - 120px);
  overflow: hidden;
}

section {
  background: var(--panel-bg);
  border: var(--border-w) solid var(--border);
  border-radius: var(--radius-3);
  padding: var(--space-3);
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}

/* =========================================================
   TYPOGRAPHY & COMMON ELEMENTS
   ========================================================= */
h2 {
  font-size: 14px;
  font-weight: 700;
  margin: 0 0 var(--space-1) 0;
  color: var(--title);
  text-transform: uppercase;
  letter-spacing: 0.06em;
}

label { font-size: 12px; color: var(--text-subtle); }

input, select, textarea {
  background: var(--input-bg);
  color: var(--fg);
  border: var(--border-w) solid var(--input-border);
  border-radius: var(--radius-1);
  padding: var(--space-2) var(--space-3);
  width: 100%;
}

textarea { min-height: 84px; resize: vertical; }

button {
  background: var(--panel-bg);
  color: var(--fg);
  border: var(--border-w) solid var(--border);
  border-radius: var(--radius-2);
  padding: var(--space-2) var(--space-3);
  cursor: pointer;
  transition: transform var(--speed-1) var(--ease-1), border-color var(--speed-1) var(--ease-1), background-color var(--speed-1) var(--ease-1);
}
button:hover { transform: translateY(-1px); border-color: var(--accent); }
button:active { transform: translateY(0); }
button:disabled { opacity: 0.5; cursor: not-allowed; }

pre, code {
  background: var(--surface-2);
  border: var(--border-w) solid var(--border);
  border-radius: var(--radius-2);
  padding: var(--space-2);
  overflow: auto;
}

.grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-3); }
.row { display: flex; gap: var(--space-2); flex-wrap: wrap; align-items: center; }
.spacer { height: var(--space-2); }
.list { flex: 1; overflow: auto; border: var(--border-w) solid var(--border); border-radius: var(--radius-2); min-height: 0; }
.collapsible summary { cursor: pointer; list-style: none; }
.collapsible summary::-webkit-details-marker { display: none; }
.collapsible summary::before { content: '▾'; display: inline-block; margin-right: var(--space-1); }
.collapsible[open] summary::before { content: '▴'; }
.collapsible .row { margin-top: var(--space-2); }
.item {
  padding: var(--space-2) var(--space-3);
  border-bottom: var(--border-w) solid var(--border);
  display: flex;
  justify-content: space-between;
  gap: var(--space-2);
}
.item:last-child { border-bottom: 0; }

.subtle { color: var(--text-muted); font-size: 12px; }
.mono { font-family: var(--font-mono); }

/* Status text helpers */
.ok  { color: var(--ok); }
.err { color: var(--err); }

/* =========================================================
   UTILITIES / TOKENS APPLIED
   ========================================================= */
.pill {
  padding: 2px 8px;
  border: var(--border-w) solid var(--border);
  border-radius: var(--radius-pill);
  font-size: 11px;
  color: var(--title);
}
.pill--yes { border-color: #115e3b; background: #0d1f19; color: var(--ok); }
.pill--no  { border-color: #5e1111; background: #1f0d0d; color: var(--err); }

.block { display: block; }
.inline { display: inline; }

.in { background: var(--input-bg); color: var(--fg); border: var(--border-w) solid var(--input-border); border-radius: var(--radius-1); padding: 6px 8px; }
.in-text, .in-number { width: 100%; }
.in-textarea { width: 100%; min-height: 96px; resize: vertical; }
.in-select { width: 100%; }
.in-range { width: 100%; }
.range-wrap { display: flex; gap: 10px; align-items: center; }
.range-readout { min-width: 44px; text-align: right; }
.combo-wrap { display: block; }

/* =========================================================
   CARDS
   ========================================================= */
.obj-card {
  border: var(--border-w) solid var(--border);
  border-radius: var(--radius-3);
  background: var(--panel-bg);
}
.obj-card__head {
  padding: 10px 12px;
  border-bottom: var(--border-w) solid var(--border);
}
.obj-card__title {
  margin: 0;
  font-size: 16px;
  color: var(--fg-strong);
  white-space: pre-wrap;
  word-break: break-word;
}
.obj-card__body {
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}
.obj-card__row { display: flex; gap: var(--space-2); align-items: flex-start; }
.obj-card__row--above { flex-direction: column; }
.obj-card__row--below { flex-direction: column-reverse; }
.obj-card__row--left { flex-direction: row; }
.obj-card__row--right { flex-direction: row-reverse; }
.obj-card__label { color: var(--text-subtle); font-size: 12px; min-width: 180px; }
.obj-card__value {
  color: var(--fg);
  font-size: 14px;
  white-space: pre-wrap;
  word-break: break-word;
  flex: 1;
}
.obj-card__error { color: var(--err); font-size: 12px; margin-top: 4px; }
.obj-card__actions { display: flex; gap: var(--space-2); flex-wrap: wrap; margin-top: var(--space-2); }
.obj-card__foot { padding: 10px 12px; border-top: var(--border-w) solid var(--border); }
.obj-card--selected { border-color: var(--accent); box-shadow: 0 0 0 1px var(--accent) inset; }

/* Button variants */
.btn { padding: 6px 10px; border: var(--border-w) solid var(--border); border-radius: var(--radius-2); background: var(--panel-bg); color: var(--fg); cursor: pointer; }
.btn--primary { border-color: var(--accent); }
.btn--danger  { border-color: var(--danger); }
.btn--ghost   { background: transparent; }

/* =========================================================
   WINDOW SYSTEM
   ========================================================= */
.window {
  position: absolute;
  background: var(--panel-bg);
  border: var(--border-w) solid var(--border);
  border-radius: var(--radius-3);
  display: flex;
  flex-direction: column;
  resize: both;
  overflow: hidden;
  min-width: var(--win-min-w);
  min-height: var(--win-min-h);
  box-shadow: var(--shadow-1);
}
.window__titlebar {
  background: var(--border);
  padding: 4px 8px;
  cursor: move;
  display: flex;
  justify-content: space-between;
  align-items: center;
  user-select: none;
}
.window__controls button {
  background: transparent;
  border: none;
  color: var(--fg);
  cursor: pointer;
  width: 24px;
  height: 24px;
  padding: var(--space-1);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
}
.window__body {
  padding: var(--space-3);
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
  flex: 1;
  overflow: auto;
  min-height: 0;
}
.window--docked { top: 0 !important; left: 0 !important; }

.window--minimized {
  min-height: 0 !important;
  height: auto !important;
  resize: none;
}

.window--minimized .window__body {
  display: none;
}

/* =========================================================
   CHAT
   ========================================================= */
.chat-history {
  flex: 1;
  overflow: auto;
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  padding: var(--space-2);
  border: var(--border-w) solid var(--border);
  border-radius: var(--radius-2);
  background: var(--surface-2);
  min-height: 0;
}
.chat-msg {
  max-width: 80%;
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius-2);
  white-space: pre-wrap;
  word-break: break-word;
}
.chat-msg--user { background: var(--accent); color: var(--accent-contrast); margin-left: auto; }
.chat-msg--bot  { background: var(--panel-bg); margin-right: auto; }

.chat-input { display: flex; flex-direction: column; gap: var(--space-2); flex-shrink: 0; }
.chat-input textarea { min-height: 80px; resize: vertical; }

.chat-ctrls { margin-bottom: var(--space-2); }

[data-id="chat"] .window__body { overflow: hidden; }
[data-id="history"] .window__body { overflow: hidden; }

/* =========================================================
   SEARCH / PERSONA AREAS
   ========================================================= */
[data-id="persona"] textarea {
  flex: 1;
  width: 100%;
  resize: none;
  white-space: pre-wrap;
  word-break: break-word;
}

#chatOut { white-space: pre-wrap; word-break: break-word; }

[data-id="search"] #searchOut {
  flex: 1;
  max-height: none;
  min-height: 0;
}
[data-id="search"] .obj-card__value,
[data-id="search"] .obj-card__title {
  white-space: pre-wrap;
  word-break: break-word;
}


/* Support both BEM spellings */
.obj-card__row--above,
.obj-card_row--above {
  align-items: stretch; /* children fill width in column layout */
}

/* Make value cell flex wide regardless of spelling */
.obj-card__value,
.obj-card_value { flex: 1 1 auto; width: 100%; }

/* Make textareas fill their container (cover both class spellings) */
.obj-card__value textarea,
.obj-card_value textarea,
.in-textarea,
.in_textarea,
textarea {
  display: block;
  width: 100% !important;
  max-width: 100%;
  min-width: 0;
  box-sizing: border-box;
  resize: vertical;
}

/* =========================================================
   FOOTER
   ========================================================= */
footer {
  padding: var(--space-3) var(--space-4);
  border-top: var(--border-w) solid var(--border);
  font-size: 12px;
  color: var(--text-muted);
}

/* =========================================================
   ACCESSIBILITY / MOTION
   ========================================================= */
@media (prefers-reduced-motion: reduce) {
  * { transition: none !important; animation: none !important; }
}
